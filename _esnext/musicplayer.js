(()=>{addEventListener("DOMContentLoaded",()=>{let o=document.getElementById("music-player"),n=document.getElementById("seek-slider"),y=document.getElementById("volume-slider"),d=document.getElementById("trigger-playback"),h=document.getElementById("mute-icon"),a="play",m="unmute";document.querySelector(".navbar").style.mixBlendMode="darken !important",d.innerHTML=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?'<span class="tag border venomous">Tap</span> to play':'Press <span class="tag border venomous">spacebar</span> to play';function g(t,s){a==="play"?(e.play(),requestAnimationFrame(r),a="pause",document.body.classList.add("venomous"),document.querySelector(".navbar-home").style.mixBlendMode="exclusion",d.innerHTML=`Press <span class="tag border venomous">${s}</span> to pause`):(e.pause(),a="play",document.body.classList.remove("venomous"),document.querySelector(".navbar-home").style.mixBlendMode="unset",d.innerHTML=`Press <span class="tag border venomous">${s}</span> to play`)}window.addEventListener("keydown",t=>{t.key===" "&&g(a,"spacebar")}),window.addEventListener("touchstart",t=>{g(a,"tap")}),h.addEventListener("click",()=>{m==="unmute"?(e.muted=!0,m="mute"):(e.muted=!1,m="unmute")});let v=t=>{t===n?o.style.setProperty("--seek-before-width",t.value/t.max*100+"%"):o.style.setProperty("--volume-before-width",t.value/t.max*100+"%")};n.addEventListener("input",t=>{v(t.target)}),y.addEventListener("input",t=>{v(t.target)});let e=document.querySelector("audio"),k=document.getElementById("duration"),l=document.getElementById("current-time"),A=document.getElementById("volume-output"),i=null,u=t=>{let s=Math.floor(t/60),p=Math.floor(t%60),b=p<10?`0${p}`:`${p}`;return`${s}:${b}`},f=()=>{k.textContent=u(e.duration)},S=()=>{n.max=Math.floor(e.duration)},c=()=>{let t=e.buffered.length?Math.floor(e.buffered.end(e.buffered.length-1)):void 0;o.style.setProperty("--buffered-width",`${t/n.max*100}%`)},r=()=>{n.value=Math.floor(e.currentTime),l.textContent=u(n.value),o.style.setProperty("--seek-before-width",`${n.value/n.max*100}%`),i=requestAnimationFrame(r)};e.readyState>0?(f(),S(),c()):e.addEventListener("loadedmetadata",()=>{f(),S(),c()}),e.addEventListener("progress",c),n.addEventListener("input",()=>{l.textContent=u(n.value),e.paused||cancelAnimationFrame(i)}),n.addEventListener("change",()=>{e.currentTime=n.value,e.paused||requestAnimationFrame(r)}),y.addEventListener("input",t=>{let s=t.target.value;A.textContent=s,e.volume=s/100}),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:"Komorebi",artist:"Anitek",album:"MainStay",artwork:[{src:"https://assets.codepen.io/4358584/1.300.jpg",sizes:"96x96",type:"image/png"},{src:"https://assets.codepen.io/4358584/1.300.jpg",sizes:"128x128",type:"image/png"},{src:"https://assets.codepen.io/4358584/1.300.jpg",sizes:"192x192",type:"image/png"},{src:"https://assets.codepen.io/4358584/1.300.jpg",sizes:"256x256",type:"image/png"},{src:"https://assets.codepen.io/4358584/1.300.jpg",sizes:"384x384",type:"image/png"},{src:"https://assets.codepen.io/4358584/1.300.jpg",sizes:"512x512",type:"image/png"}]}),navigator.mediaSession.setActionHandler("play",()=>{a==="play"?(e.play(),playAnimation.playSegments([14,27],!0),requestAnimationFrame(r),a="pause"):(e.pause(),playAnimation.playSegments([0,14],!0),cancelAnimationFrame(i),a="play")}),navigator.mediaSession.setActionHandler("pause",()=>{a==="play"?(e.play(),playAnimation.playSegments([14,27],!0),requestAnimationFrame(r),a="pause"):(e.pause(),playAnimation.playSegments([0,14],!0),cancelAnimationFrame(i),a="play")}),navigator.mediaSession.setActionHandler("seekbackward",t=>{e.currentTime=e.currentTime-(t.seekOffset||10)}),navigator.mediaSession.setActionHandler("seekforward",t=>{e.currentTime=e.currentTime+(t.seekOffset||10)}),navigator.mediaSession.setActionHandler("seekto",t=>{if(t.fastSeek&&"fastSeek"in e){e.fastSeek(t.seekTime);return}e.currentTime=t.seekTime}),navigator.mediaSession.setActionHandler("stop",()=>{e.currentTime=0,n.value=0,o.style.setProperty("--seek-before-width","0%"),l.textContent="0:00",a==="pause"&&(playAnimation.playSegments([0,14],!0),cancelAnimationFrame(i),a="play")}))});})();
